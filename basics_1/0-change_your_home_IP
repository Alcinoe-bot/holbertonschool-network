#!/usr/bin/env bash
# Configure /etc/hosts: localhost -> 127.0.0.2 and facebook.com -> 8.8.8.8

# 1) Mettre localhost sur 127.0.0.2
sudo sed -i -E '/^127\.0\.0\.1[[:space:]].*\blocalhost\b/ s/^127\.0\.0\.1/127.0.0.2/' /etc/hosts

# 2) S'assurer que l'entrée 127.0.0.2 localhost existe
if ! grep -qE '^[[:space:]]*127\.0\.0\.2[[:space:]]+localhost([[:space:]]|$)' /etc/hosts; then
  printf '127.0.0.2 localhost\n' | sudo tee -a /etc/hosts >/dev/null
fi

# 3) Forcer facebook.com à 8.8.8.8
sudo sed -i -E '/[[:space:]]facebook\.com([[:space:]]|$)/d' /etc/hosts
printf '8.8.8.8 facebook.com\n' | sudo tee -a /etc/hosts >/dev/null
